From c095d07fc9fc2b7f6d1b4646dd75950ff98d0bdd Mon Sep 17 00:00:00 2001
From: auto3000 <auto3000@users.noreply.github.com>
Date: Thu, 4 Apr 2019 07:25:49 +0200
Subject: [PATCH] configure: fix chmod -w issue on Azure pipeline

---
 Makefile.comm.in  | 2 +-
 config/aclocal.m4 | 2 +-
 configure         | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/Makefile.comm.in b/Makefile.comm.in
index 24d17a4..4c4b7df 100644
--- a/Makefile.comm.in
+++ b/Makefile.comm.in
@@ -53,7 +53,7 @@ CXXDEPGENFLAGS=-MM
 .m4.cxx:
 	rm -f $@
 	$(PERL) $(srcdir)/../instmac.pl $< >$@
-	chmod -w $@
+	chmod u-w $@
 
 %.h %.cxx %.rc: %.msg
 	$(PERL) -w $(srcdir)/../msggen.pl $(MSGGENFLAGS) $<
diff --git a/config/aclocal.m4 b/config/aclocal.m4
index 1166122..38e9256 100644
--- a/config/aclocal.m4
+++ b/config/aclocal.m4
@@ -1016,7 +1016,7 @@ mkdir out
 # the output directory.  Thus, making CWD read-only will cause this test
 # to fail, enabling locking or at least warning the user not to do parallel
 # builds.
-chmod -w .
+chmod u-w .
 save_CFLAGS="$CFLAGS"
 CFLAGS="$CFLAGS -o out/conftest2.$ac_objext"
 compiler_c_o=no
diff --git a/configure b/configure
index c024af6..5e073f5 100755
--- a/configure
+++ b/configure
@@ -7358,7 +7358,7 @@ mkdir out
 # the output directory.  Thus, making CWD read-only will cause this test
 # to fail, enabling locking or at least warning the user not to do parallel
 # builds.
-chmod -w .
+chmod u-w .
 save_CFLAGS="$CFLAGS"
 CFLAGS="$CFLAGS -o out/conftest2.$ac_objext"
 compiler_c_o=no
-- 
2.7.4

